<div class="registro-container">
  <div class="registro-content">

    <!-- Sección del formulario -->
    <div class="form-section">
      <div class="form-container">
        <div class="form-header">
          <h2>Registro de Usuario</h2>
          <p>Completa tus datos para crear una cuenta</p>
        </div>
        
        <form [formGroup]="registroForm" (ngSubmit)="onSubmit()" class="p-fluid form-grid">
          <!-- Primera fila: Nombres y Apellidos -->
          <div class="form-row">
            <div class="p-field p-col-6">
              <label for="nombres" class="p-label">
                <i class="pi pi-user"></i>
                Nombres *
              </label>
              <input 
                id="nombres" 
                type="text" 
                pInputText 
                formControlName="nombres" 
                placeholder="Ingresa tus nombres"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="registroForm.get('nombres')?.invalid && registroForm.get('nombres')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('nombres')?.errors?.['required']">
                  Los nombres son obligatorios
                </span>
                <span *ngIf="registroForm.get('nombres')?.errors?.['minlength']">
                  Mínimo 2 caracteres
                </span>
              </small>
            </div>

            <div class="p-field p-col-6">
              <label for="apellidos" class="p-label">
                Apellidos *
              </label>
              <input 
                id="apellidos" 
                type="text" 
                pInputText 
                formControlName="apellidos" 
                placeholder="Ingresa tus apellidos"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="registroForm.get('apellidos')?.invalid && registroForm.get('apellidos')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('apellidos')?.errors?.['required']">
                  Los apellidos son obligatorios
                </span>
                <span *ngIf="registroForm.get('apellidos')?.errors?.['minlength']">
                  Mínimo 2 caracteres
                </span>
              </small>
            </div>
          </div>

          <!-- Correo -->
          <div class="p-field">
            <label for="correo" class="p-label">
              <i class="pi pi-envelope"></i>
              Correo Electrónico *
            </label>
            <input 
              id="correo" 
              type="email" 
              pInputText 
              formControlName="correo" 
              placeholder="ejemplo@correo.com"
              class="p-inputtext-lg" 
            />
            <small 
              *ngIf="registroForm.get('correo')?.invalid && registroForm.get('correo')?.touched" 
              class="p-error"
            >
              <span *ngIf="registroForm.get('correo')?.errors?.['required']">
                El correo es obligatorio
              </span>
              <span *ngIf="registroForm.get('correo')?.errors?.['email']">
                Ingresa un correo válido
              </span>
            </small>
          </div>

          <!-- Segunda fila: Contraseñas -->
          <div class="form-row">
            <div class="p-field p-col-6">
              <label for="contrasena" class="p-label">
                <i class="pi pi-lock"></i>
                Contraseña *
              </label>
              <div class="password-group">
                <input 
                  [type]="showPassword ? 'text' : 'password'" 
                  pInputText 
                  formControlName="contrasena" 
                  placeholder="Mínimo 8 caracteres"
                  class="p-inputtext-lg" 
                />
                <button
                  type="button" 
                  pButton 
                  icon="pi {{ showPassword ? 'pi-eye-slash' : 'pi-eye' }}" 
                  class="p-button-text toggle-password"
                  (click)="togglePasswordVisibility()"
                >
                </button>
              </div>
              <small 
                *ngIf="registroForm.get('contrasena')?.invalid && registroForm.get('contrasena')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('contrasena')?.errors?.['required']">
                  La contraseña es obligatoria
                </span>
                <span *ngIf="registroForm.get('contrasena')?.errors?.['minlength']">
                  Mínimo 8 caracteres
                </span>
              </small>
            </div>

            <div class="p-field p-col-6">
              <label for="confirmarContrasena" class="p-label">
                Confirmar Contraseña *
              </label>
              <input 
                [type]="showPassword ? 'text' : 'password'" 
                pInputText 
                formControlName="confirmarContrasena" 
                placeholder="Confirma tu contraseña"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="registroForm.get('confirmarContrasena')?.invalid && registroForm.get('confirmarContrasena')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('confirmarContrasena')?.errors?.['required']">
                  Confirma tu contraseña
                </span>
                <span *ngIf="registroForm.get('confirmarContrasena')?.errors?.['passwordMismatch']">
                  Las contraseñas no coinciden
                </span>
              </small>
            </div>
          </div>

          <!-- Tercera fila: Identificación y Teléfono -->
          <div class="form-row">
            <div class="p-field p-col-6">
              <label for="numeroIdentificacion" class="p-label">
                <i class="pi pi-id-card"></i>
                N° Identificación *
              </label>
              <input 
                id="numeroIdentificacion" 
                type="text" 
                pInputText 
                formControlName="numeroIdentificacion" 
                placeholder="Número de identificación"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="registroForm.get('numeroIdentificacion')?.invalid && registroForm.get('numeroIdentificacion')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('numeroIdentificacion')?.errors?.['required']">
                  El número de identificación es obligatorio
                </span>
              </small>
            </div>

            <div class="p-field p-col-6">
              <label for="telefono" class="p-label">
                <i class="pi pi-phone"></i>
                Teléfono *
              </label>
              <input 
                id="telefono" 
                type="text" 
                pInputText 
                formControlName="telefono" 
                placeholder="Número de teléfono"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="registroForm.get('telefono')?.invalid && registroForm.get('telefono')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('telefono')?.errors?.['required']">
                  El teléfono es obligatorio
                </span>
              </small>
            </div>
          </div>

          <!-- Cuarta fila: Fecha Nacimiento y Género -->
          <div class="form-row">
            <div class="p-field p-col-6">
              <label for="fechaNacimiento" class="p-label">
                <i class="pi pi-calendar"></i>
                Fecha de Nacimiento *
              </label>
              <p-datepicker
                id="fechaNacimiento"
                formControlName="fechaNacimiento"
                [maxDate]="maxDate"
                [showIcon]="true"
                placeholder="Selecciona tu fecha de nacimiento"
                inputId="icon"
                class="w-100"
              ></p-datepicker>
              <small 
                *ngIf="registroForm.get('fechaNacimiento')?.invalid && registroForm.get('fechaNacimiento')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('fechaNacimiento')?.errors?.['required']">
                  La fecha de nacimiento es obligatoria
                </span>
              </small>
            </div>

            <div class="p-field p-col-6">
              <label for="genero" class="p-label">
                <i class="pi pi-users"></i>
                Género *
              </label>
              <p-select
                id="genero"
                formControlName="genero"
                [options]="generos"
                placeholder="Selecciona tu género"
                optionLabel="label"
                styleClass="w-full"
                optionValue="value"
              ></p-select>
              <small 
                *ngIf="registroForm.get('genero')?.invalid && registroForm.get('genero')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('genero')?.errors?.['required']">
                  El género es obligatorio
                </span>
              </small>
            </div>
          </div>

          <!-- Quinta fila: Grupo Sanguíneo y Dirección -->
          <div class="form-row">
            <div class="p-field p-col-6">
              <label for="grupoSanguineo" class="p-label">
                <i class="pi pi-heart"></i>
                Grupo Sanguíneo *
              </label>
              <p-select
                id="grupoSanguineo"
                formControlName="grupoSanguineo"
                [options]="gruposSanguineos"
                placeholder="Selecciona grupo sanguíneo"
                optionLabel="label"
                styleClass="w-full"
                optionValue="value"
              ></p-select>
              <small 
                *ngIf="registroForm.get('grupoSanguineo')?.invalid && registroForm.get('grupoSanguineo')?.touched" 
                class="p-error"
              >
                <span *ngIf="registroForm.get('grupoSanguineo')?.errors?.['required']">
                  El grupo sanguíneo es obligatorio
                </span>
              </small>
            </div>

            <div class="p-field p-col-6">
              <label for="direccion" class="p-label">
                <i class="pi pi-home"></i>
                Dirección
              </label>
              <input 
                id="direccion" 
                type="text" 
                pInputText 
                formControlName="direccion" 
                placeholder="Dirección (opcional)"
                class="p-inputtext-lg" 
              />
            </div>
          </div>

          <!-- Alergias -->
          <div class="p-field">
            <label for="alergias" class="p-label">
              <i class="pi pi-info-circle"></i>
              Alergias Conocidas
            </label>
            <textarea
              id="alergias"
              pInputTextarea
              formControlName="alergias"
              placeholder="Lista tus alergias conocidas (opcional)"
              [rows]="3"
              class="p-inputtext-lg"
            ></textarea>
          </div>

          <!-- Botones -->
          <div class="buttons-container">
            <button
              pButton 
              type="submit" 
              label="Registrarse" 
              class="p-button-lg register-button"
              [disabled]="registroForm.invalid"
            >
            </button>

            <p-divider align="center">
              <span class="p-tag">o</span>
            </p-divider>

            <button 
              pButton 
              type="button" 
              label="Volver al Login" 
              class="p-button-lg volver-button"
              (click)="onVolver()"
            >

            <p-toast></p-toast>

            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
