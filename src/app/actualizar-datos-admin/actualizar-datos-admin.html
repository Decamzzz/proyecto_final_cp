<div class="registro-container">
  <div class="registro-content">
    <!-- Sección del formulario -->
    <div class="form-section">
      <div class="form-container">
        <div class="form-header">
          <h2>Actualización de Datos de Administrador</h2>
          <p>Actualiza tu información de acceso</p>
        </div>
        
        <form [formGroup]="actualizacionForm" (ngSubmit)="onSubmit()" class="p-fluid form-grid">
          <!-- Información actual (solo lectura) -->
          <div class="user-info">
            <div class="info-item">
              <strong>Usuario Actual:</strong> {{ adminActual?.Username }}
            </div>
          </div>

          <!-- Nuevo Username -->
          <div class="p-field">
            <label for="username" class="p-label">
              <i class="pi pi-user"></i>
              Nuevo Nombre de Usuario *
            </label>
            <input 
              id="username" 
              type="text" 
              pInputText 
              formControlName="username" 
              placeholder="Nuevo nombre de usuario"
              class="p-inputtext-lg" 
            />
            <small 
              *ngIf="actualizacionForm.get('username')?.invalid && actualizacionForm.get('username')?.touched" 
              class="p-error"
            >
              <span *ngIf="actualizacionForm.get('username')?.errors?.['required']">
                El nombre de usuario es obligatorio
              </span>
              <span *ngIf="actualizacionForm.get('username')?.errors?.['minlength']">
                Mínimo 3 caracteres
              </span>
            </small>
          </div>

          <!-- Contraseña actual -->
          <div class="p-field">
            <label for="contrasenaActual" class="p-label">
              <i class="pi pi-lock"></i>
              Contraseña Actual *
            </label>
            <div class="password-group">
              <input 
                [type]="showPassword ? 'text' : 'password'" 
                pInputText 
                formControlName="contrasenaActual" 
                placeholder="Ingresa tu contraseña actual para poder realizar los cambios"
                class="p-inputtext-lg" 
              />
              <button
                type="button" 
                pButton 
                icon="pi {{ showPassword ? 'pi-eye-slash' : 'pi-eye' }}" 
                class="p-button-text toggle-password"
                (click)="togglePasswordVisibility()"
              >
              </button>
            </div>
            <small 
              *ngIf="actualizacionForm.get('contrasenaActual')?.invalid && actualizacionForm.get('contrasenaActual')?.touched" 
              class="p-error"
            >
              <span *ngIf="actualizacionForm.get('contrasenaActual')?.errors?.['required']">
                La contraseña actual es obligatoria
              </span>
            </small>
          </div>

          <!-- Nueva contraseña -->
          <div class="form-row">
            <div class="p-field p-col-6">
              <label for="nuevaContrasena" class="p-label">
                <i class="pi pi-lock"></i>
                Nueva Contraseña
              </label>
              <input 
                [type]="showPassword ? 'text' : 'password'" 
                pInputText 
                formControlName="nuevaContrasena" 
                placeholder="Dejar en blanco para no cambiar"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="actualizacionForm.get('nuevaContrasena')?.invalid && actualizacionForm.get('nuevaContrasena')?.touched" 
                class="p-error"
              >
                <span *ngIf="actualizacionForm.get('nuevaContrasena')?.errors?.['minlength']">
                  Mínimo 8 caracteres
                </span>
              </small>
            </div>

            <div class="p-field p-col-6">
              <label for="confirmarContrasena" class="p-label">
                Confirmar Nueva Contraseña
              </label>
              <input 
                [type]="showPassword ? 'text' : 'password'" 
                pInputText 
                formControlName="confirmarContrasena" 
                placeholder="Confirmar nueva contraseña"
                class="p-inputtext-lg" 
              />
              <small 
                *ngIf="actualizacionForm.get('confirmarContrasena')?.invalid && actualizacionForm.get('confirmarContrasena')?.touched" 
                class="p-error"
              >
                <span *ngIf="actualizacionForm.get('confirmarContrasena')?.errors?.['passwordMismatch']">
                  Las contraseñas no coinciden
                </span>
              </small>
            </div>
          </div>

          <!-- Botones -->
          <div class="buttons-container">
            <button
              pButton 
              type="submit" 
              [label]="isLoading ? 'Actualizando...' : 'Actualizar Datos'" 
              class="p-button-lg actualizar-button"
              [disabled]="actualizacionForm.invalid || isLoading"
            >
              <i *ngIf="isLoading" class="pi pi-spin pi-spinner" style="margin-right: 0.5rem"></i>
            </button>

            <p-divider align="center">
              <span class="p-tag">o</span>
            </p-divider>

            <button 
              pButton 
              type="button" 
              label="Volver al Dashboard" 
              class="p-button-lg volver-button"
              (click)="onVolver()"
            >
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<p-toast></p-toast>
